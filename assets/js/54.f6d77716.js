(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{448:function(t,a,s){t.exports=s.p+"assets/img/BlobAPI.163d6ecb.png"},655:function(t,a,s){"use strict";s.r(a);var r=s(10),e=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"blob"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#blob"}},[t._v("#")]),t._v(" Blob")]),t._v(" "),a("h2",{attrs:{id:"_1-基本概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-基本概念"}},[t._v("#")]),t._v(" 1.基本概念")]),t._v(" "),a("p",[a("strong",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Blob",target:"_blank",rel:"noopener noreferrer"}},[t._v("Blob"),a("OutboundLink")],1),t._v("（Binary Large Object）"),a("strong",[t._v("表示")]),t._v("二进制类型的大对象")]),t._v("。在 JavaScript 中 Blob 对象表示一个不可变、原始数据的"),a("strong",{staticStyle:{color:"#DD5145"}},[t._v("类文件对象")]),t._v("。")]),t._v(" "),a("p",[t._v("在数据库管理系统中，将二进制数据存储为一个单一个体的集合。Blob 通常是影像、声音或多媒体文件。")]),t._v(" "),a("p",[t._v("Blob 表示的不一定是 JavaScript 原生格式的数据")]),t._v(" "),a("h2",{attrs:{id:"_2-blob-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-blob-api"}},[t._v("#")]),t._v(" 2.Blob API")]),t._v(" "),a("p",[a("code",[t._v("Blob")]),t._v(" 由一个可选的字符串 "),a("code",[t._v("type")]),t._v("（通常是 MIME 类型）和 "),a("code",[t._v("blobParts")]),t._v(" 组成：")]),t._v(" "),a("p",[a("img",{attrs:{src:s(448),alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("MIME（Multipurpose Internet Mail Extensions）"),a("strong",[t._v("多用途互联网邮件扩展类型")]),t._v("，是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。")])]),t._v(" "),a("h3",{attrs:{id:"构造函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构造函数"}},[t._v("#")]),t._v(" 构造函数")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" aBlob "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Blob")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("strong",[t._v("array")]),t._v(" 是一个由"),a("code",[t._v("ArrayBuffer")]),t._v(", "),a("code",[t._v("ArrayBufferView")]),t._v(", "),a("code",[t._v("Blob")]),t._v(", "),a("code",[t._v("DOMString")]),t._v(" 等对象构成的 "),a("code",[t._v("Array")]),t._v(" ，或者其他类似对象的混合体，它将会被放进 "),a("code",[t._v("Blob")]),t._v("。DOMStrings 会被编码为 UTF-8。")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("options")]),t._v("：一个可选的对象，包含以下两个属性：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v('type —— 默认值为 " "，它代表了将会被放入到 blob 中的数组内容的 MIME 类型。')])]),t._v(" "),a("li",[a("p",[t._v('endings —— 默认值为 "transparent"，用于指定包含行结束符 \\n 的字符串如何被写入。')]),t._v(" "),a("p",[t._v('它是以下两个值中的一个： "native"，代表行结束符会被更改为适合宿主操作系统文件系统的换行符，或者 "transparent"，代表会保持 blob 中保存的结束符不变。')])])])])]),t._v(" "),a("h3",{attrs:{id:"实例属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例属性"}},[t._v("#")]),t._v(" 实例属性")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("size")]),t._v("（只读）：表示 "),a("code",[t._v("Blob")]),t._v(" 对象中所包含数据的大小（以字节为单位）。")]),t._v(" "),a("li",[a("strong",[t._v("type")]),t._v("（只读）：一个字符串，表明该 "),a("code",[t._v("Blob")]),t._v(" 对象所包含数据的 MIME 类型。如果类型未知，则该值为空字符串。")])]),t._v(" "),a("h3",{attrs:{id:"实例方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例方法"}},[t._v("#")]),t._v(" 实例方法")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[a("code",[t._v("slice([start[, end[, contentType]]])")])]),t._v("：返回一个新的 Blob 对象，包含了源 Blob 对象中指定范围内的数据。")])]),t._v(" "),a("li",[a("p",[a("strong",[a("code",[t._v("stream()")])]),t._v("：返回一个能读取 Blob 内容的 "),a("code",[t._v("ReadableStream")]),t._v("。Stream API 中的 "),a("code",[t._v("ReadableStream")]),t._v(" 接口表示可读的字节数据流")])]),t._v(" "),a("li",[a("p",[a("strong",[a("code",[t._v("text()")])]),t._v("：返回一个 Promise 对象且包含 Blob 所有内容的 UTF-8 格式的 "),a("code",[t._v("USVString")]),t._v("。")])]),t._v(" "),a("li",[a("p",[a("strong",[a("code",[t._v("arrayBuffer()")])]),t._v("：返回一个 Promise 对象且包含 blob 所有内容的二进制格式的 "),a("code",[t._v("ArrayBuffer")]),t._v("。")])])]),t._v(" "),a("p",[a("strong",{staticStyle:{color:"#DD5145"}},[t._v("Blob 对象是不可改变的")]),t._v("。我们不能直接在一个 Blob 中更改数据，但是我们可以对一个 Blob 进行分割，从其中创建新的 Blob 对象，将它们混合到一个新的 Blob 中。这种行为类似于 JavaScript 字符串：我们无法更改字符串中的字符，但可以创建新的更正后的字符串。")]),t._v(" "),a("h2",{attrs:{id:"_3-blob-使用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-blob-使用场景"}},[t._v("#")]),t._v(" 3.Blob 使用场景")]),t._v(" "),a("h3",{attrs:{id:"_1-分片上传"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-分片上传"}},[t._v("#")]),t._v(" 1.分片上传")]),t._v(" "),a("p",[a("strong",{staticStyle:{color:"#DD5145"}},[t._v("File 对象是特殊类型的 Blob（file对象是blob的子类）")]),t._v("，且可以用在任意的 Blob 类型的上下文中。所以针对大文件传输的场景，我们可以使用 slice 方法对大文件进行切割，然后分片进行上传")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" file "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("repeat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" chunkSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("40000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://httpbin.org/post"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chunkedUpload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" chunkSize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" chunk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" chunkSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FormData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        fd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("body")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" fd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n            res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-从互联网下载数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-从互联网下载数据"}},[t._v("#")]),t._v(" 2.从互联网下载数据")]),t._v(" "),a("p",[t._v("可以使用以下方法从互联网上下载数据并将数据存储到 Blob 对象中")]),t._v(" "),a("h3",{attrs:{id:"_3-blob-用作-url"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-blob-用作-url"}},[t._v("#")]),t._v(" 3.Blob 用作 URL")]),t._v(" "),a("h3",{attrs:{id:"_4-blob-转换为-base64"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-blob-转换为-base64"}},[t._v("#")]),t._v(" 4.Blob 转换为 Base64")]),t._v(" "),a("p",[a("strong",[a("code",[t._v("URL.createObjectURL")])]),t._v(" 的一个替代方法是，将 "),a("code",[t._v("Blob")]),t._v(" 转换为 base64 编码的字符串。")]),t._v(" "),a("h3",{attrs:{id:"_5-图片压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-图片压缩"}},[t._v("#")]),t._v(" 5.图片压缩")]),t._v(" "),a("p",[t._v("在一些场合中，我们希望在上传本地图片时，先对图片进行一定的压缩，然后再提交到服务器，从而减少传输的数据量。在前端要实现图片压缩，我们可以利用 Canvas 对象提供的 "),a("code",[t._v("toDataURL()")]),t._v(" 方法，该方法接收 "),a("code",[t._v("type")]),t._v(" 和 "),a("code",[t._v("encoderOptions")]),t._v(" 两个可选参数。")]),t._v(" "),a("blockquote",[a("ul",[a("li",[a("code",[t._v("type")]),t._v(" 表示图片格式，默认为 "),a("code",[t._v("image/png")]),t._v("。")]),t._v(" "),a("li",[a("code",[t._v("encoderOptions")]),t._v(" 用于表示图片的质量，在指定图片格式为 "),a("code",[t._v("image/jpeg")]),t._v(" 或 "),a("code",[t._v("image/webp")]),t._v(" 的情况下，可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 "),a("code",[t._v("0.92")]),t._v("，其他参数会被忽略。")])])]),t._v(" "),a("h3",{attrs:{id:"_6-生成-pdf-文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-生成-pdf-文档"}},[t._v("#")]),t._v(" 6.生成 PDF 文档")]),t._v(" "),a("p",[t._v("PDF（便携式文件格式，Portable Document Format）是由 Adobe Systems 在 1993 年用于文件交换所发展出的文件格式。")]),t._v(" "),a("p",[t._v("在浏览器端，利用一些现成的开源库，比如 jsPDF，我们也可以方便地生成 PDF 文档。")]),t._v(" "),a("h2",{attrs:{id:"_4-blob-与-arraybuffer-的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-blob-与-arraybuffer-的区别"}},[t._v("#")]),t._v(" 4.Blob 与 ArrayBuffer 的区别")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("Blob")]),t._v(" 类型的对象表示不可变的类似文件对象的原始数据。Blob 表示的不一定是 JavaScript 原生格式的数据。")]),t._v(" "),a("p",[t._v("File 接口基于 Blob，继承了Blob 功能并将其扩展为支持用户系统上的文件。")])]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("ArrayBuffer")]),t._v(" 类型的对象用于表示通用的，固定长度的原始二进制数据缓冲区。")]),t._v(" "),a("p",[t._v("你不能直接操纵 ArrayBuffer 的内容，而是需要创建一个类型化数组对象或 DataView 对象，该对象以特定格式表示缓冲区，并使用该对象读取和写入缓冲区的内容。")])]),t._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/yaojiqic/article/details/125090825",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章"),a("OutboundLink")],1),t._v("、"),a("a",{attrs:{href:"https://segmentfault.com/a/1190000022812794",target:"_blank",rel:"noopener noreferrer"}},[t._v("你不知道的 Blob"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);