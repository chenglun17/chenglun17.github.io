(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{460:function(t,s,a){t.exports=a.p+"assets/img/image-20230620163412427.6a9785be.png"},461:function(t,s){t.exports="data:image/png;base64,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"},462:function(t,s,a){t.exports=a.p+"assets/img/nginx.e53e1381.png"},463:function(t,s,a){t.exports=a.p+"assets/img/node.9c561cac.png"},664:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"五、跨域问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、跨域问题"}},[t._v("#")]),t._v(" 五、跨域问题")]),t._v(" "),s("h2",{attrs:{id:"什么是跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是跨域"}},[t._v("#")]),t._v(" ⭐️什么是跨域")]),t._v(" "),s("p",[s("strong",{staticStyle:{color:"#DD5145"}},[t._v("跨域本质是浏览器基于同源策略的一种安全手段。")])]),t._v(" "),s("p",[t._v("跨域就是当在页面上发送ajax请求时，由于浏览器同源策略的限制，要求当前页面和服务端必须同源，否则浏览器视为跨域，进行拦截。")]),t._v(" "),s("p",[s("strong",[t._v("同源策略（Same-Origin Policy）")]),t._v(" 是浏览器的一种安全策略，可以防止某些恶意行为：")]),t._v(" "),s("ul",[s("li",[t._v("同源："),s("strong",[t._v("协议")]),t._v(" + "),s("strong",[t._v("域名")]),t._v(" + "),s("strong",[t._v("端口号")]),t._v(" 必须完全相同，这三者是确定站点的唯一标识符")]),t._v(" "),s("li",[t._v("跨域：三者之间任意一个与当前页面 url 不同即为跨域，违背同源策略就是跨域")])]),t._v(" "),s("p",[s("strong",[t._v("同源策略限制以下几种行为：")])]),t._v(" "),s("ul",[s("li",[t._v("Cookie、LocalStorage 和 IndexDB 无法读取")]),t._v(" "),s("li",[t._v("DOM 和 JS对象无法获得")]),t._v(" "),s("li",[t._v("Ajax 请求不能发送")])]),t._v(" "),s("p",[t._v("一定要注意"),s("strong",{staticStyle:{color:"#DD5145"}},[t._v("跨域限制是浏览器行为，不是服务器行为")]),t._v("。用抓包工具抓取接口数据，可以看到接口已经把数据返回回来了，只是浏览器的限制，你获取不到数据。")]),t._v(" "),s("p",[t._v("用 postman 请求接口能够请求到数据，这些再次印证了跨域是浏览器的限制。")]),t._v(" "),s("p",[s("code",[t._v("client")])]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("跨域问题"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:8000/test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[s("img",{attrs:{src:a(460),alt:""}})]),t._v(" "),s("p",[s("code",[t._v("server.js")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOST")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'8000'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOSTNAME")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOST")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你好'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("serve is running at ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOSTNAME")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"如何解决跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何解决跨域"}},[t._v("#")]),t._v(" ⭐️如何解决跨域")]),t._v(" "),s("p",[t._v("解决跨域的方法有很多，下面列举了几种：")]),t._v(" "),s("ul",[s("li",[t._v("JSONP")]),t._v(" "),s("li",[t._v("CORS")]),t._v(" "),s("li",[t._v("代理服务器")]),t._v(" "),s("li",[t._v("NodeJs 中间代理跨域")]),t._v(" "),s("li",[t._v("postMessage 跨域")]),t._v(" "),s("li",[t._v("WebSocket 跨域")])]),t._v(" "),s("p",[t._v("而在"),s("code",[t._v("vue")]),t._v("项目中，我们主要针对"),s("code",[t._v("CORS")]),t._v("或"),s("code",[t._v("Proxy")]),t._v("这两种方案进行展开。")]),t._v(" "),s("h3",{attrs:{id:"_1-jsonp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-jsonp"}},[t._v("#")]),t._v(" 1.JSONP")]),t._v(" "),s("p",[s("strong",[t._v("JSONP（JSON with Padding）")]),t._v("，是非官方的跨域解决方案，"),s("strong",{staticStyle:{color:"#DD5145"}},[t._v("只支持 GET 请求")]),t._v("。")]),t._v(" "),s("p",[t._v("有一些标签天生具有跨域能力，比如：img、link、iframe、script。")]),t._v(" "),s("p",[t._v("本质利用了"),s("code",[t._v("script")]),t._v("标签"),s("code",[t._v("src")]),t._v("引入外部资源不受浏览器同源策略的限制，然后和后端一起配合来解决跨域问题的。")]),t._v(" "),s("ul",[s("li",[t._v("JSONP 和 Ajax 之间没有任何关系，不能把 JSONP 请求数据的方式叫做 Ajax，因为 JSONP 没有用到 XMLHttpRequest 对象。")]),t._v(" "),s("li",[t._v("JSONP 的优点就是兼容性好，可以解决主流浏览器的跨域问题，缺点是仅支持GET请求，不安全，可能遭受xss攻击。")])]),t._v(" "),s("p",[t._v("应用场景：有些第三方数据接口可能会使用JSONP解决跨域问题，工作不经常使用")]),t._v(" "),s("p",[s("strong",[t._v("具体实现：")]),t._v(" 动态生成script标签，通过src属性进行加载")]),t._v(" "),s("ol",[s("li",[t._v("在客户端创建一个"),s("code",[t._v("script")]),t._v("标签，然后把请求后端的接口拼接一个回调函数"),s("code",[t._v("func")]),t._v("名称作为参数传递给后端")]),t._v(" "),s("li",[t._v("当后端接收到客户端的请求时，会解析得到回调函数名称，然后把数据和回调函数名称拼接成函数调用的形式返回")]),t._v(" "),s("li",[t._v("客户端解析后会调用定义好的回调函数，然后在回调函数中就可以获取到后端返回的数据了。")])]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("跨域问题"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    ")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://127.0.0.1:8000/test?callback=func"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[s("img",{attrs:{src:a(461),alt:""}})]),t._v(" "),s("p",[s("code",[t._v("node.js")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOST")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'8000'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOSTNAME")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOST")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取客户端传来的回调函数名称")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" funcName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("callback\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模拟返回数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" msg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你好'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 把数据和回调函数名称拼接成函数调用的方式返回")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("funcName"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("('")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("')")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("serve is running at ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOSTNAME")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-cors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-cors"}},[t._v("#")]),t._v(" 2.CORS")]),t._v(" "),s("p",[s("strong",[s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORS"),s("OutboundLink")],1),t._v("（Cross-Origin Resource Sharing，跨域资源共享）")]),t._v(" 是官方的跨域解决方案，它的特点是不需要在客户端做任何特殊的操作，完全在服务器中进行处理，"),s("strong",{staticStyle:{color:"#DD5145"}},[t._v("同时支持 GET 和 POST 请求")]),t._v("。")]),t._v(" "),s("p",[t._v("CORS 是通过设置一个响应头来告诉浏览器，该请求允许跨域，浏览器收到该响应以后就会对响应放行。")]),t._v(" "),s("p",[t._v("以nodejs为例，在服务器 server.js 文件中配置：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOST")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'8000'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOSTNAME")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOST")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置响应头允许跨域")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你好'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("serve is running at ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HOSTNAME")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("blockquote",[s("p",[s("code",[t._v("Access-Control-Allow-Origin")]),t._v(" 设置为 "),s("strong",[s("code",[t._v("*")])]),t._v(" 其实意义不大，可以说是形同虚设，实际应用中，上线前我们会将"),s("code",[t._v("Access-Control-Allow-Origin")]),t._v(" 值设为我们目标"),s("code",[t._v("host")])])]),t._v(" "),s("h3",{attrs:{id:"_3-代理服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-代理服务器"}},[t._v("#")]),t._v(" 3.代理服务器")]),t._v(" "),s("p",[t._v("在日常的项目开发中，解决跨域问题最常使用的方案是使用代理服务器")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("什么是代理？")])]),t._v(" "),s("ul",[s("li",[t._v("常规 ：A客户端 向 B服务器 请求")]),t._v(" "),s("li",[t._v("变成： 代理服务器C收的A的请求，C请求B返回给 A客户端 （"),s("strong",[t._v("服务器之间请求不存在跨域")]),t._v("）")])])]),t._v(" "),s("p",[t._v("代理服务器解决跨域是利用了"),s("strong",[t._v("同源策略只受限于浏览器访问服务器，而对于服务器访问服务器并没有限制")]),t._v("的特点，作为中间服务器做了一个请求转发的功能。")]),t._v(" "),s("p",[t._v("具体来说，就是当前端网页在浏览器中发起网络请求时，其实这个请求是发送到代理服务器上的，然后代理服务器会将请求转发给目标服务器，再将目标服务器返回的响应转发给客户端。")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("注意，在"),s("a",{attrs:{href:"#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"}},[t._v("开发环境")]),t._v("和"),s("a",{attrs:{href:"#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83"}},[t._v("生产环境")]),t._v("中，我们通常会使用不同的方式实现代理。")]),t._v(" "),s("h4",{attrs:{id:"开发环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开发环境"}},[t._v("#")]),t._v(" 开发环境")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("vue-cli")]),t._v("脚手架工具搭建的项目中，可以通过"),s("code",[t._v("webpack")]),t._v("建立一个本地服务器作为请求的代理对象。")]),t._v(" "),s("p",[t._v("通过该服务器转发请求至目标服务器，得到结果再转发给前端，但是最终发布上线时如果 Web 应用和接口服务器不在一起仍会跨域。")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("vue.config.js")]),t._v("文件配置：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lintOnSave")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭语法检查")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("devServer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// host: '127.0.0.1',")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// port: 8080,")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue项目启动时自动打开浏览器")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置代理")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("proxy")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '/api' 是代理标识，用于告诉 node，url 前面是 /api 的就是使用代理的")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'/api'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("target")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://xxx.xxx.xx.xx:8080'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 目标地址，一般是指后台服务器地址")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ws")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否启用 WebSockets")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("changeOrigin")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开启代理，会在本地创建一个虚拟服务器")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// pathRewrite 的作用是把实际 Request Url 中的 '/api' 用 '/' 代替")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pathRewrite")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'^/api'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("通过"),s("code",[t._v("axios")]),t._v("发送请求中，配置请求的根路径")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseURL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api'")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("devServe.proxy")]),t._v(" 提供的代理功能，仅在开发调试阶段生效")]),t._v(" "),s("li",[t._v("项目上线发布时，依旧需要API接口服务器开启 CORS 跨域资源共享")])]),t._v(" "),s("h4",{attrs:{id:"生产环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生产环境"}},[t._v("#")]),t._v(" 生产环境")]),t._v(" "),s("p",[t._v("在线上环境下，一般会采用 "),s("strong",[t._v("Nginx")]),t._v(" 来做反向代理解决跨域问题，也是利用了服务器请求服务器不受浏览器同源策略的限制实现的。")]),t._v(" "),s("p",[t._v("通过 Nginx 反向代理解决跨域的"),s("strong",[t._v("优点")]),t._v("是可以集中管理跨域请求，"),s("strong",[t._v("缺点")]),t._v("是需要额外的服务器和维护成本。")]),t._v(" "),s("p",[t._v("客户端请求 Nginx 服务器，在 nginx.config 配置文件中配置server监听客户端的请求，然后把 location 匹配的路径代理到真实的服务器，服务器处理请求后返回数据，Nginx 再把数据给客户端返回。")]),t._v(" "),s("p",[t._v("大致流程如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(462),alt:""}})]),t._v(" "),s("p",[t._v("1.修改 Nginx 的配置文件，在 http 块中添加以下内容：")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许跨域请求的地址")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许跨域请求的方法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Methods'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET, POST, PUT, DELETE, OPTIONS'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许跨域请求的请求头")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Origin, X-Requested-With, Content-Type, Accept, Authorization'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许跨域请求的请求头中可以携带的信息")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Expose-Headers'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Authorization'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许跨域请求携带 Cookie")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Credentials'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'true'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    ...\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("2.在 server 块中添加以下内容：")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" example.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将 /api 转发到 http://api.example.com")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /api")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://api.example.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Host "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X-Real-IP "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这个配置表示将客户端请求的 "),s("strong",[t._v("/api")]),t._v(" 转发到 "),s("strong",[t._v("http://api.example.com")]),t._v("，并将客户端请求的头信息中的 Host 和 X-Real-IP 添加到后端请求的头信息中。这样就可以通过 Nginx 反向代理解决跨域问题了。")]),t._v(" "),s("h3",{attrs:{id:"_4-nodejs-中间代理跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-nodejs-中间代理跨域"}},[t._v("#")]),t._v(" 4.NodeJs 中间代理跨域")]),t._v(" "),s("p",[t._v("因为同源策略是浏览器限制的，所以"),s("strong",[t._v("服务端请求服务器是不受浏览器同源策略的限制的")]),t._v("，因此我们可以搭建一个自己的node服务器来代理访问服务器。")]),t._v(" "),s("p",[t._v("大致流程：我们在客户端请求自己的Node代理服务器，然后在Node代理服务器中转发客户端的请求访问服务器，服务器处理请求后给代理服务器响应数据，然后在代理服务器中把服务器响应的数据再返回给客户端。")]),t._v(" "),s("p",[s("img",{attrs:{src:a(463),alt:""}})]),t._v(" "),s("p",[t._v("客户端和自己搭建的代理服务器之间也存在跨域问题，所以需要在代理服务器中设置CORS。")]),t._v(" "),s("p",[t._v("客户端：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 引入axios发送请求 --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://unpkg.com/axios/dist/axios.min.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 简单封装一个axios向代理服务器发送请求")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxyAxios")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("axios")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:8081/proxyApi'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求自己搭建的node代理服务器的地址")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("headers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/x-www-form-urlencoded'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            data\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用node代理服务器向服务器发送请求")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxyAxios")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://class.imooc.com/getadver'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 需要代理访问真实服务器的url")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'res:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("Node服务器：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**通过nodeJS搭建自己的代理服务器来解决跨域问题 */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyParser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'body-parser'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用第三方插件")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyParser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("urlencoded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("extended")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyParser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听post请求,处理代理接口")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/proxyApi'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取post请求的请求参数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" reqParams "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        reqParams "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取到请求参数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置响应头 ")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 代理服务器设置CORS，允许跨域访问")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Methods'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许所有的请求方式")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("resConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" reqParams "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// node代理请求服务器")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("axios")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("resConfig\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" result\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 给客户端返回数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听请求")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'服务启动成功，在8081端口监听请求....'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("以"),s("code",[t._v("express")]),t._v("框架为例，利用node + express + http-proxy-middleware搭建一个proxy服务器。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" proxy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http-proxy-middleware'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("express"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("static")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("target")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:4000'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("changeOrigin")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app\n")])])]),s("p",[t._v("express有一个自带的中间件cors，它的作用是自动给每一个res设置默认请求头，这样就不用我们自己每一个接口都要设置一次了。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.下包 ")]),t._v("\n$ npm install cors\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.配置中间件 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cors'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_5-postmessage-跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-postmessage-跨域"}},[t._v("#")]),t._v(" 5.postMessage 跨域")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage",target:"_blank",rel:"noopener noreferrer"}},[t._v("window.postMessage()"),s("OutboundLink")],1),t._v(" 方法可以安全地实现跨源通信，此方法一种受控机制来规避此限制，只要正确的使用，这种方法就很安全。")]),t._v(" "),s("p",[t._v("主要的用途是实现多窗口，多文档之间通信：")]),t._v(" "),s("ul",[s("li",[t._v("页面和其打开的新窗口的数据传递")]),t._v(" "),s("li",[t._v("多窗口之间消息传递")]),t._v(" "),s("li",[t._v("页面与嵌套的 iframe 消息传递")])]),t._v(" "),s("h3",{attrs:{id:"_6-websocket-跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-websocket-跨域"}},[t._v("#")]),t._v(" 6.WebSocket 跨域")]),t._v(" "),s("p",[t._v("使用 Websocket 也可以解决跨域问题，因为 WebSocket 本身不存在跨域问题，所以可以利用 WebSocket 来进行非同源之间的通信。")]),t._v(" "),s("p",[t._v("WebSocket 规范定义了一个在 Web 浏览器和服务器之间建立“套接字”连接的 API。 简单来说：客户端和服务器之间存在持久连接，双方可以随时开始发送数据。")]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" ⭐️总结")]),t._v(" "),s("ul",[s("li",[t._v("jsonp的原理是利用了script标签不受浏览器同源策略的限制，img和link标签也是不受浏览器同源策略限制的。")]),t._v(" "),s("li",[t._v("跨域是浏览器限制，服务端和服务端之间通信是不受浏览器同源策略限制的。")]),t._v(" "),s("li",[t._v("所有跨域的解决方案都是需要服务端配合的。")]),t._v(" "),s("li",[t._v("最常用的跨域解决方案是CORS、Node代理服务器和Nginx反向代理方式。")]),t._v(" "),s("li",[t._v("postMessage更多的是用在多个文档，窗口之间发送数据。")]),t._v(" "),s("li")]),t._v(" "),s("h2",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 📄参考")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://vue3js.cn/interview/vue/cors.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://blog.csdn.net/qq_45334976/article/details/125113481",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章2"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://blog.csdn.net/qq_52822043/article/details/124438656",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章3"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://blog.csdn.net/m0_37873510/article/details/126558023",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://blog.csdn.net/qq_42691298/article/details/129767095",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);