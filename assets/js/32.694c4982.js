(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{375:function(t,a,s){t.exports=s.p+"assets/img/分包前.ceb14496.png"},376:function(t,a,s){t.exports=s.p+"assets/img/分包后.c19c1f16.png"},617:function(t,a,s){"use strict";s.r(a);var r=s(10),e=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"小程序分包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序分包"}},[t._v("#")]),t._v(" 小程序分包")]),t._v(" "),a("h2",{attrs:{id:"基础概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础概念"}},[t._v("#")]),t._v(" ⭐️基础概念")]),t._v(" "),a("h3",{attrs:{id:"_1-什么是分包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是分包"}},[t._v("#")]),t._v(" 1.什么是分包")]),t._v(" "),a("p",[t._v("分包指的是把一个完整的小程序项目，按照需求划分为不同的子包，在构建时打包成不同的分包，用户在使用时按需加载。")]),t._v(" "),a("h3",{attrs:{id:"_2-分包的好处"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-分包的好处"}},[t._v("#")]),t._v(" 2.分包的好处")]),t._v(" "),a("p",[t._v("对小程序进行分包的好处主要有以下两点：")]),t._v(" "),a("ul",[a("li",[t._v("可以优化小程序首次启动的下载时间")]),t._v(" "),a("li",[t._v("在多团队共同开发时可以更好的解耦协作")])]),t._v(" "),a("h3",{attrs:{id:"_3-分包前项目的构成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-分包前项目的构成"}},[t._v("#")]),t._v(" 3.分包前项目的构成")]),t._v(" "),a("p",[t._v("分包前，小程序项目中所有的页面和资源都被打包到一起，导致整个项目体积过大，影响小程序首次启动的下载时间。")]),t._v(" "),a("p",[a("img",{attrs:{src:s(375),alt:""}})]),t._v(" "),a("h3",{attrs:{id:"_4-分包后项目的构成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-分包后项目的构成"}},[t._v("#")]),t._v(" 4.分包后项目的构成")]),t._v(" "),a("p",[t._v("分包后，小程序项目由 1个主包 + 多个分包 组成：")]),t._v(" "),a("ul",[a("li",[t._v("主包：一般只包含项目的"),a("strong",[t._v("启动页面")]),t._v("或"),a("strong",[t._v("TabBar页面")]),t._v("、以及所有分包都需要用到的一些公共资源")]),t._v(" "),a("li",[t._v("分包：只包含和当前分包有关的页面和私有资源")])]),t._v(" "),a("p",[a("img",{attrs:{src:s(376),alt:""}})]),t._v(" "),a("h3",{attrs:{id:"_5-分包的加载规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-分包的加载规则"}},[t._v("#")]),t._v(" 5.分包的加载规则")]),t._v(" "),a("ol",[a("li",[t._v("在小程序启动时，默认会下载主包并启动主包页面\n"),a("ul",[a("li",[t._v("tabBar 页面需要放到主包中")])])]),t._v(" "),a("li",[t._v("当用户进入分包内某个页面时，客户端会把对应分包下载下来，下载完成后再进行展示\n"),a("ul",[a("li",[t._v("非 tabBar 页面可以按照功能的不同，划分为不同的分包之后，进行按需下载")])])])]),t._v(" "),a("h3",{attrs:{id:"_6-分包的体积限制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-分包的体积限制"}},[t._v("#")]),t._v(" 6.分包的体积限制")]),t._v(" "),a("p",[t._v("目前，小程序分包的大小有以下两个限制：")]),t._v(" "),a("ul",[a("li",[t._v("整个小程序所有分包大小不超过 16M（主包+所有分包）")]),t._v(" "),a("li",[t._v("单个分包/主包不能超过 2M")])]),t._v(" "),a("h2",{attrs:{id:"使用分包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用分包"}},[t._v("#")]),t._v(" ⭐️使用分包")]),t._v(" "),a("h3",{attrs:{id:"_1-配置方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-配置方法"}},[t._v("#")]),t._v(" 1.配置方法")]),t._v(" "),a("p",[t._v("在 app.json 的 subpackages 节点中声明分包的结构")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pages"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//主页的所有页面")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/home/home"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/message/message"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/contact/contact"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"subPackages"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//通过 subpackages 节点，声明分包的结构")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"root"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pkgA"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//第一个分包的根目录")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pages"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当前分包下，所有页面的相对存放路径")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/cat/cat"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/dog/dog"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"root"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pkgB"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//第二个分包的根目录")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pack2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//分包的别名")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pages"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当前分包下，所有页面的相对存放路径")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/apple/apple"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-打包原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-打包原则"}},[t._v("#")]),t._v(" 2.打包原则")]),t._v(" "),a("ol",[a("li",[t._v("小程序会按 subpackages 的配置进行分包，subpackages 之外的目录将被打包到主包中")]),t._v(" "),a("li",[t._v("主包也可以有自己的 pages（即最外层的 pages 字段）")]),t._v(" "),a("li",[t._v("tabBar 页面必须在主包内")]),t._v(" "),a("li",[t._v("分包之间不能相互嵌套，只能平级关系")])]),t._v(" "),a("h3",{attrs:{id:"_3-引用原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-引用原则"}},[t._v("#")]),t._v(" 3.引用原则")]),t._v(" "),a("ol",[a("li",[t._v("主包无法引用分包内的私有资源")]),t._v(" "),a("li",[t._v("分包之间不能相互引用私有资源")]),t._v(" "),a("li",[t._v("分包可以引用主包内的公共资源")])]),t._v(" "),a("h2",{attrs:{id:"独立分包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#独立分包"}},[t._v("#")]),t._v(" ⭐️独立分包")]),t._v(" "),a("h3",{attrs:{id:"_1-什么是独立分包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是独立分包"}},[t._v("#")]),t._v(" 1.什么是独立分包")]),t._v(" "),a("p",[t._v("独立分包本质上也是分包，只不过它比较特殊，可以独立于主包和其他分包而单独运行。")]),t._v(" "),a("h3",{attrs:{id:"_2-独立分包和普通分包的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-独立分包和普通分包的区别"}},[t._v("#")]),t._v(" 2.独立分包和普通分包的区别")]),t._v(" "),a("p",[t._v("最主要的区别：是否依赖于主包才能运行")]),t._v(" "),a("ul",[a("li",[t._v("普通分包必须依赖于主包才能运行")]),t._v(" "),a("li",[t._v("独立分包可以在下载主包的情况下，独立运行")])]),t._v(" "),a("h3",{attrs:{id:"_3-独立分包的应用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-独立分包的应用场景"}},[t._v("#")]),t._v(" 3.独立分包的应用场景")]),t._v(" "),a("p",[t._v("开发者可以按需，将某些具有一定功能独立性的页面配置到独立分包中。原因如下：")]),t._v(" "),a("ul",[a("li",[t._v("当小程序从普通的分包页面启动时，需要首先下载分包")]),t._v(" "),a("li",[t._v("而独立分包不依赖主包即可运行，可以很大程度上提升分包页面的启动速度")])]),t._v(" "),a("p",[t._v("注意：一个小程序中可以有多个独立分包。")]),t._v(" "),a("h3",{attrs:{id:"_4-独立分包的配置方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-独立分包的配置方法"}},[t._v("#")]),t._v(" 4.独立分包的配置方法")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//与 subpackages中分包里的root、name、pages平级")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"independent"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n")])])]),a("h3",{attrs:{id:"_5-引用原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-引用原则"}},[t._v("#")]),t._v(" 5.引用原则")]),t._v(" "),a("p",[t._v("独立分包何普通分包以及主包之间，是相互隔离的，不能相互引用彼此的资源！例如：")]),t._v(" "),a("ol",[a("li",[t._v("主包无法引用独立分包内的私有资源")]),t._v(" "),a("li",[t._v("独立分包之间，不能相互引用私有资源")]),t._v(" "),a("li",[t._v("独立分包和普通分包之间，不能相互引用私有资源")]),t._v(" "),a("li",[t._v("特别注意：独立分包中不能引用主包内的公共资源")])]),t._v(" "),a("h2",{attrs:{id:"分包预下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分包预下载"}},[t._v("#")]),t._v(" ⭐️分包预下载")]),t._v(" "),a("h3",{attrs:{id:"_1-什么是分包预下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是分包预下载"}},[t._v("#")]),t._v(" 1.什么是分包预下载")]),t._v(" "),a("p",[t._v("分包预下载指的是：在进入小程序的某个页面时，由框架自动预下载可能需要的分包，从而提升进入后续分包页面时的启动速度。")]),t._v(" "),a("h3",{attrs:{id:"_2-配置分包的预下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置分包的预下载"}},[t._v("#")]),t._v(" 2.配置分包的预下载")]),t._v(" "),a("p",[t._v("预下载分包的行为，会在进入指定的页面时触发。在 app.json 中，使用 preloadRule 节点定义分包的预下载规则，"),a("em",[t._v("示例代码如下：")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n\t"preloadRule": {\t//分包预下载的规则\n\t\t"pages/contact/contact": {\t//触发分包预下载的页面路径\n\t\t\t//network 表示在指定的网络模式下进行预下载\n\t\t\t//可选值为：all（不限网络）和 wifi（仅 wifi 模式下进行预下载）\n\t\t\t//默认值为：wifi\n\t\t\t"network": "all",\n\t\t\t//packages 表示进入页面后，预下载哪些分包\n\t\t\t//可以通过 root 或 name 指定预下载哪些分包\n\t\t\t"packages": ["pkgA"]\n\t\t}\n\t}\n}\n')])])]),a("h3",{attrs:{id:"_3-分包预下载的限制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-分包预下载的限制"}},[t._v("#")]),t._v(" 3.分包预下载的限制")]),t._v(" "),a("p",[t._v("同一个分包中的页面享有共同的预下载大小限额 2M，例如：")])])}),[],!1,null,null,null);a.default=e.exports}}]);